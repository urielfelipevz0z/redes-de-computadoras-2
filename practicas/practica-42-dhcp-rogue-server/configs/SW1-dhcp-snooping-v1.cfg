!
! Switch SW1 - Configuración DHCP Snooping
! Práctica 42: DHCP Rogue Server - Mitigación
! Configuración de protección contra servidores DHCP no autorizados
!
hostname SW1
!
! Habilitar DHCP Snooping globalmente
ip dhcp snooping
ip dhcp snooping vlan 1
!
! Opcional: Habilitar para múltiples VLANs
! ip dhcp snooping vlan 10,20,30
!
! Configuración de puerto trusted (hacia servidor/router DHCP legítimo)
interface GigabitEthernet0/1
 description Uplink hacia Router R1 (DHCP Server) - TRUSTED
 ip dhcp snooping trust
 no shutdown
!
! Configuración de puertos untrusted (hacia clientes)
interface FastEthernet0/1
 description Puerto de acceso cliente - UNTRUSTED
 ! No requiere configuración adicional, untrusted es el default
 ! Limitar tasa de paquetes DHCP para prevenir starvation
 ip dhcp snooping limit rate 10
 no shutdown
!
interface FastEthernet0/2
 description Puerto de acceso cliente - UNTRUSTED
 ip dhcp snooping limit rate 10
 no shutdown
!
interface FastEthernet0/3
 description Puerto de acceso cliente - UNTRUSTED
 ip dhcp snooping limit rate 10
 no shutdown
!
interface FastEthernet0/4
 description Puerto de acceso cliente - UNTRUSTED
 ip dhcp snooping limit rate 10
 no shutdown
!
! Verificar que Option 82 esté deshabilitada si causa problemas
! no ip dhcp snooping information option
!
end
